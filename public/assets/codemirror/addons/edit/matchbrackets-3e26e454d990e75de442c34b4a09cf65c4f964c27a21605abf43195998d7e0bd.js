!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){function e(t,e,i,s){var r=t.getLineHandle(e.line),l=e.ch-1,c=l>=0&&o[r.text.charAt(l)]||o[r.text.charAt(++l)];if(!c)return null;var d=">"==c.charAt(1)?1:-1;if(i&&d>0!=(l==e.ch))return null;var u=t.getTokenTypeAt(a(e.line,l+1)),h=n(t,a(e.line,l+(d>0?1:0)),d,u||null,s);return null==h?null:{from:a(e.line,l),to:h&&h.pos,match:h&&h.ch==c.charAt(0),forward:d>0}}function n(t,e,n,i,s){for(var r=s&&s.maxScanLineLength||1e4,l=s&&s.maxScanLines||1e3,c=[],d=s&&s.bracketRegex?s.bracketRegex:/[(){}[\]]/,u=n>0?Math.min(e.line+l,t.lastLine()+1):Math.max(t.firstLine()-1,e.line-l),h=e.line;h!=u;h+=n){var f=t.getLine(h);if(f){var p=n>0?0:f.length-1,g=n>0?f.length:-1;if(!(f.length>r))for(h==e.line&&(p=e.ch-(n<0?1:0));p!=g;p+=n){var m=f.charAt(p);if(d.test(m)&&(void 0===i||t.getTokenTypeAt(a(h,p+1))==i)){var v=o[m];if(">"==v.charAt(1)==n>0)c.push(m);else{if(!c.length)return{pos:a(h,p),ch:m};c.pop()}}}}}return h-n!=(n>0?t.lastLine():t.firstLine())&&null}function i(t,n,i){for(var s=t.state.matchBrackets.maxHighlightLineLength||1e3,o=[],l=t.listSelections(),c=0;c<l.length;c++){var d=l[c].empty()&&e(t,l[c].head,!1,i);if(d&&t.getLine(d.from.line).length<=s){var u=d.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";o.push(t.markText(d.from,a(d.from.line,d.from.ch+1),{className:u})),d.to&&t.getLine(d.to.line).length<=s&&o.push(t.markText(d.to,a(d.to.line,d.to.ch+1),{className:u}))}}if(o.length){r&&t.state.focused&&t.focus();var h=function(){t.operation(function(){for(var t=0;t<o.length;t++)o[t].clear()})};if(!n)return h;setTimeout(h,800)}}function s(t){t.operation(function(){l&&(l(),l=null),l=i(t,!1,t.state.matchBrackets)})}var r=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),a=t.Pos,o={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},l=null;t.defineOption("matchBrackets",!1,function(e,n,i){i&&i!=t.Init&&e.off("cursorActivity",s),n&&(e.state.matchBrackets="object"==typeof n?n:{},e.on("cursorActivity",s))}),t.defineExtension("matchBrackets",function(){i(this,!0)}),t.defineExtension("findMatchingBracket",function(t,n,i){return e(this,t,n,i)}),t.defineExtension("scanForBracket",function(t,e,i,s){return n(this,t,e,i,s)})});