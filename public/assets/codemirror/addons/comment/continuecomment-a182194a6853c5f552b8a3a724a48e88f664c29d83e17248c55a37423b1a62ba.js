!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){function e(e){if(e.getOption("disableInput"))return t.Pass;for(var i,s=e.listSelections(),r=[],a=0;a<s.length;a++){var o=s[a].head,l=e.getTokenAt(o);if("comment"!=l.type)return t.Pass;var c=t.innerMode(e.getMode(),l.state).mode;if(i){if(i!=c)return t.Pass}else i=c;var d=null;if(i.blockCommentStart&&i.blockCommentContinue){var u,h=l.string.indexOf(i.blockCommentEnd),f=e.getRange(t.Pos(o.line,0),t.Pos(o.line,l.end));if(h!=-1&&h==l.string.length-i.blockCommentEnd.length&&o.ch>=h);else if(0==l.string.indexOf(i.blockCommentStart)){if(d=f.slice(0,l.start),!/^\s*$/.test(d)){d="";for(var p=0;p<l.start;++p)d+=" "}}else(u=f.indexOf(i.blockCommentContinue))!=-1&&u+i.blockCommentContinue.length>l.start&&/^\s*$/.test(f.slice(0,u))&&(d=f.slice(0,u));null!=d&&(d+=i.blockCommentContinue)}if(null==d&&i.lineComment&&n(e)){var g=e.getLine(o.line),u=g.indexOf(i.lineComment);u>-1&&(d=g.slice(0,u),/\S/.test(d)?d=null:d+=i.lineComment+g.slice(u+i.lineComment.length).match(/^\s*/)[0])}if(null==d)return t.Pass;r[a]="\n"+d}e.operation(function(){for(var t=s.length-1;t>=0;t--)e.replaceRange(r[t],s[t].from(),s[t].to(),"+insert")})}function n(t){var e=t.getOption("continueComments");return!e||"object"!=typeof e||e.continueLineComment!==!1}for(var i=["clike","css","javascript"],s=0;s<i.length;++s)t.extendMode(i[s],{blockCommentContinue:" * "});t.defineOption("continueComments",null,function(n,i,s){if(s&&s!=t.Init&&n.removeKeyMap("continueComment"),i){var r="Enter";"string"==typeof i?r=i:"object"==typeof i&&i.key&&(r=i.key);var a={name:"continueComment"};a[r]=e,n.addKeyMap(a)}})});