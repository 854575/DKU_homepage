!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.registerGlobalHelper("fold","comment",function(t){return t.blockCommentStart&&t.blockCommentEnd},function(e,n){var i=e.getModeAt(n),s=i.blockCommentStart,r=i.blockCommentEnd;if(s&&r){for(var a,o=n.line,l=e.getLine(o),c=n.ch,d=0;;){var u=c<=0?-1:l.lastIndexOf(s,c-1);if(u!=-1){if(1==d&&u<n.ch)return;if(/comment/.test(e.getTokenTypeAt(t.Pos(o,u+1)))&&(0==u||l.slice(u-r.length,u)==r||!/comment/.test(e.getTokenTypeAt(t.Pos(o,u))))){a=u+s.length;break}c=u-1}else{if(1==d)return;d=1,c=l.length}}var h,f,p=1,g=e.lastLine();t:for(var m=o;m<=g;++m)for(var v=e.getLine(m),_=m==o?a:0;;){var y=v.indexOf(s,_),b=v.indexOf(r,_);if(y<0&&(y=v.length),b<0&&(b=v.length),_=Math.min(y,b),_==v.length)break;if(_==y)++p;else if(!--p){h=m,f=_;break t}++_}if(null!=h&&(o!=h||f!=a))return{from:t.Pos(o,a),to:t.Pos(h,f)}}})});