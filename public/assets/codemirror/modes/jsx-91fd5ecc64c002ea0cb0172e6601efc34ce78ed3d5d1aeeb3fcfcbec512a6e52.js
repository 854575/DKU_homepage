!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],t):t(CodeMirror)}(function(t){"use strict";function e(t,e,n,i){this.state=t,this.mode=e,this.depth=n,this.prev=i}function n(i){return new e(t.copyState(i.mode,i.state),i.mode,i.depth,i.prev&&n(i.prev))}t.defineMode("jsx",function(i,r){function o(t){var e=t.tagName;t.tagName=null;var n=c.indent(t,"");return t.tagName=e,n}function a(t,e){return e.context.mode==c?s(t,e,e.context):l(t,e,e.context)}function s(n,r,s){if(2==s.depth)return n.match(/^.*?\*\//)?s.depth=1:n.skipToEnd(),"comment";if("{"==n.peek()){c.skipAttribute(s.state);var l=o(s.state),d=s.state.context;if(d&&n.match(/^[^>]*>\s*$/,!1)){for(;d.prev&&!d.startOfLine;)d=d.prev;d.startOfLine?l-=i.indentUnit:s.prev.state.lexical&&(l=s.prev.state.lexical.indented)}else 1==s.depth&&(l+=i.indentUnit);return r.context=new e(t.startState(u,l),u,0,r.context),null}if(1==s.depth){if("<"==n.peek())return c.skipAttribute(s.state),r.context=new e(t.startState(c,o(s.state)),c,0,r.context),null;if(n.match("//"))return n.skipToEnd(),"comment";if(n.match("/*"))return s.depth=2,a(n,r)}var f,h=c.token(n,s.state),p=n.current();return/\btag\b/.test(h)?/>$/.test(p)?s.state.context?s.depth=0:r.context=r.context.prev:/^</.test(p)&&(s.depth=1):!h&&(f=p.indexOf("{"))>-1&&n.backUp(p.length-f),h}function l(n,i,r){if("<"==n.peek()&&u.expressionAllowed(n,r.state))return u.skipExpression(r.state),i.context=new e(t.startState(c,u.indent(r.state,"")),c,0,i.context),null;var o=u.token(n,r.state);if(!o&&null!=r.depth){var a=n.current();"{"==a?r.depth++:"}"==a&&0==--r.depth&&(i.context=i.context.prev)}return o}var c=t.getMode(i,{name:"xml",allowMissing:!0,multilineTagIndentPastTag:!1}),u=t.getMode(i,r&&r.base||"javascript");return{startState:function(){return{context:new e(t.startState(u),u)}},copyState:function(t){return{context:n(t.context)}},token:a,indent:function(t,e,n){return t.context.mode.indent(t.context.state,e,n)},innerMode:function(t){return t.context}}},"xml","javascript"),t.defineMIME("text/jsx","jsx")});