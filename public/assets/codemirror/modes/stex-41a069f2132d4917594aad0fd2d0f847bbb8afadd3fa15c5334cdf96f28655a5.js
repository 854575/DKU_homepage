!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("stex",function(){function e(e,t){e.cmdState.push(t)}function t(e){return e.cmdState.length>0?e.cmdState[e.cmdState.length-1]:null}function n(e){var t=e.cmdState.pop();t&&t.closeBracket()}function i(e){for(var t=e.cmdState,n=t.length-1;n>=0;n--){var i=t[n];if("DEFAULT"!=i.name)return i}return{styleIdentifier:function(){return null}}}function r(e,t,n){return function(){this.name=e,this.bracketNo=0,this.style=t,this.styles=n,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,"bracket"},this.closeBracket=function(){}}}function o(e,t){e.f=t}function a(n,r){var a;if(n.match(/^\\[a-zA-Z@]+/)){var u=n.current().slice(1);return a=c[u]||c.DEFAULT,a=new a,e(r,a),o(r,l),a.style}if(n.match(/^\\[$&%#{}_]/))return"tag";if(n.match(/^\\[,;!\/\\]/))return"tag";if(n.match("\\["))return o(r,function(e,t){return s(e,t,"\\]")}),"keyword";if(n.match("$$"))return o(r,function(e,t){return s(e,t,"$$")}),"keyword";if(n.match("$"))return o(r,function(e,t){return s(e,t,"$")}),"keyword";var d=n.next();return"%"==d?(n.skipToEnd(),"comment"):"}"==d||"]"==d?(a=t(r))?(a.closeBracket(d),o(r,l),"bracket"):"error":"{"==d||"["==d?(a=c.DEFAULT,a=new a,e(r,a),"bracket"):/\d/.test(d)?(n.eatWhile(/[\w.%]/),"atom"):(n.eatWhile(/[\w\-_]/),a=i(r),"begin"==a.name&&(a.argument=n.current()),a.styleIdentifier())}function s(e,t,n){if(e.eatSpace())return null;if(e.match(n))return o(t,a),"keyword";if(e.match(/^\\[a-zA-Z@]+/))return"tag";if(e.match(/^[a-zA-Z]+/))return"variable-2";if(e.match(/^\\[$&%#{}_]/))return"tag";if(e.match(/^\\[,;!\/]/))return"tag";if(e.match(/^[\^_&]/))return"tag";if(e.match(/^[+\-<>|=,\/@!*:;'"`~#?]/))return null;if(e.match(/^(\d+\.\d*|\d*\.\d+|\d+)/))return"number";var i=e.next();return"{"==i||"}"==i||"["==i||"]"==i||"("==i||")"==i?"bracket":"%"==i?(e.skipToEnd(),"comment"):"error"}function l(e,i){var r,s=e.peek();return"{"==s||"["==s?(r=t(i),r.openBracket(s),e.eat(s),o(i,a),"bracket"):/[ \t\r]/.test(s)?(e.eat(s),null):(o(i,a),n(i),a(e,i))}var c={};return c.importmodule=r("importmodule","tag",["string","builtin"]),c.documentclass=r("documentclass","tag",["","atom"]),c.usepackage=r("usepackage","tag",["atom"]),c.begin=r("begin","tag",["atom"]),c.end=r("end","tag",["atom"]),c.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{startState:function(){return{cmdState:[],f:a}},copyState:function(e){return{cmdState:e.cmdState.slice(),f:e.f}},token:function(e,t){return t.f(e,t)},blankLine:function(e){e.f=a,e.cmdState.length=0},lineComment:"%"}}),e.defineMIME("text/x-stex","stex"),e.defineMIME("text/x-latex","stex")});