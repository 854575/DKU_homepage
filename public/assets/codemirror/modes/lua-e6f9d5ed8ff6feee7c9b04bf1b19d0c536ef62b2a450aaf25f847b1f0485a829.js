!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.defineMode("lua",function(t,e){function n(t){return new RegExp("^(?:"+t.join("|")+")","i")}function i(t){return new RegExp("^(?:"+t.join("|")+")$","i")}function r(t){for(var e=0;t.eat("=");)++e;return t.eat("["),e}function o(t,e){var n=t.next();return"-"==n&&t.eat("-")?t.eat("[")&&t.eat("[")?(e.cur=a(r(t),"comment"))(t,e):(t.skipToEnd(),"comment"):'"'==n||"'"==n?(e.cur=s(n))(t,e):"["==n&&/[\[=]/.test(t.peek())?(e.cur=a(r(t),"string"))(t,e):/\d/.test(n)?(t.eatWhile(/[\w.%]/),"number"):/[\w_]/.test(n)?(t.eatWhile(/[\w\\\-_.]/),"variable"):null}function a(t,e){return function(n,i){for(var r,a=null;null!=(r=n.next());)if(null==a)"]"==r&&(a=0);else if("="==r)++a;else{if("]"==r&&a==t){i.cur=o;break}a=null}return e}}function s(t){return function(e,n){for(var i,r=!1;null!=(i=e.next())&&(i!=t||r);)r=!r&&"\\"==i;return r||(n.cur=o),"string"}}var l=t.indentUnit,c=i(e.specials||[]),u=i(["_G","_VERSION","assert","collectgarbage","dofile","error","getfenv","getmetatable","ipairs","load","loadfile","loadstring","module","next","pairs","pcall","print","rawequal","rawget","rawset","require","select","setfenv","setmetatable","tonumber","tostring","type","unpack","xpcall","coroutine.create","coroutine.resume","coroutine.running","coroutine.status","coroutine.wrap","coroutine.yield","debug.debug","debug.getfenv","debug.gethook","debug.getinfo","debug.getlocal","debug.getmetatable","debug.getregistry","debug.getupvalue","debug.setfenv","debug.sethook","debug.setlocal","debug.setmetatable","debug.setupvalue","debug.traceback","close","flush","lines","read","seek","setvbuf","write","io.close","io.flush","io.input","io.lines","io.open","io.output","io.popen","io.read","io.stderr","io.stdin","io.stdout","io.tmpfile","io.type","io.write","math.abs","math.acos","math.asin","math.atan","math.atan2","math.ceil","math.cos","math.cosh","math.deg","math.exp","math.floor","math.fmod","math.frexp","math.huge","math.ldexp","math.log","math.log10","math.max","math.min","math.modf","math.pi","math.pow","math.rad","math.random","math.randomseed","math.sin","math.sinh","math.sqrt","math.tan","math.tanh","os.clock","os.date","os.difftime","os.execute","os.exit","os.getenv","os.remove","os.rename","os.setlocale","os.time","os.tmpname","package.cpath","package.loaded","package.loaders","package.loadlib","package.path","package.preload","package.seeall","string.byte","string.char","string.dump","string.find","string.format","string.gmatch","string.gsub","string.len","string.lower","string.match","string.rep","string.reverse","string.sub","string.upper","table.concat","table.insert","table.maxn","table.remove","table.sort"]),d=i(["and","break","elseif","false","nil","not","or","return","true","function","end","if","then","else","do","while","repeat","until","for","in","local"]),f=i(["function","if","repeat","do","\\(","{"]),h=i(["end","until","\\)","}"]),p=n(["end","until","\\)","}","else","elseif"]);return{startState:function(t){return{basecol:t||0,indentDepth:0,cur:o}},token:function(t,e){if(t.eatSpace())return null;var n=e.cur(t,e),i=t.current();return"variable"==n&&(d.test(i)?n="keyword":u.test(i)?n="builtin":c.test(i)&&(n="variable-2")),"comment"!=n&&"string"!=n&&(f.test(i)?++e.indentDepth:h.test(i)&&--e.indentDepth),n},indent:function(t,e){var n=p.test(e);return t.basecol+l*(t.indentDepth-(n?1:0))},lineComment:"--",blockCommentStart:"--[[",blockCommentEnd:"]]"}}),t.defineMIME("text/x-lua","lua")});